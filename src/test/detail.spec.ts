import { Crawler, Detail } from '../main';

describe('Test Detail Method', () => {

  /**
   * å“ˆå“ˆå“ˆå“ˆä¸­æ–‡å˜é‡ï¼Œä¼šä¸ä¼šæŠ¥é”™å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆðŸ˜‚ã€‚
   *
   * å“¦è‰¹ï¼Œæ²¡åŠžæ³•æ™ºèƒ½æç¤ºäº†ðŸ˜‘ã€‚
   */
  const é­”å‘å¥‡ç¼˜ = { "source": "https://www.80s.tw/movie/6587", "image": "//t.dyxz.la/upload/img/201312/6587.jpg", "title": "é­”å‘å¥‡ç¼˜", "year": 2010, "introduction": "è¿ªæ–¯å°¼å…¬å¸ç¬¬50éƒ¨åŠ¨ç”»é•¿ç‰‡", "aliases": ["é­”å‘å¥‡ç¼˜", "é•¿å‘å§‘å¨˜", "èŽ´è‹£å…¬ä¸»", "ç¼ ç»“", "Rapunzel", "é•¿å‘å…¬ä¸»", "Tangled"], "artists": ["æœ—Â·æ™®å°”æ›¼", "æ°å¼—é‡ŒÂ·å¡”ä¼¯", "æ›¼è¿ªÂ·æ‘©å°”", "å¸ƒæ‹‰å¾·Â·åŠ å†…ç‰¹", "ç†æŸ¥å¾·Â·åŸºå°”", "å”çº³Â·å¢¨è²", "æ‰Žå…‹ç‘žÂ·èŽ±ç»´", "å¾·èŽ±å°¼Â·ç½—æ–¯Â·æ–¯å¦", "è¿ˆå…‹Â·åº·çº³Â·ç›–å°¼", "ä¿ç½—Â·FÂ·æ±¤æ™®é‡‘æ–¯"], "types": ["å–œå‰§", "çˆ±æƒ…", "å¥‡å¹»", "åŠ¨ç”»", "æ­Œèˆž"], "areas": ["ç¾Žå›½"], "languages": ["è‹±è¯­"], "directors": ["å†…æ£®Â·æ ¼é›·è¯º", "æ‹œä¼¦Â·éœåŽå¾·"], "releaseDate": 1290528000000, "updateDate": 1385856000000, "duration": 100, "rating": 8.1, "douban": { "id": 1863766, "commentLink": "https://movie.douban.com/subject/1863766/comments", "movieLink": "https://movie.douban.com/subject/1863766" }, "description": "å¥³å·«Gothelï¼ˆå”çº³Â·å¢¨è² Donna Murphy é…éŸ³ï¼‰é ç€ä¸€æœµç¥žå¥‡çš„é‡‘è‰²èŠ±æœµä¿æŒé’æ˜¥ã€‚çŽ‹åŽé‡ç—…ï¼Œå›½çŽ‹æ´¾äººæ‰¾åˆ°äº†è¿™æœµé‡‘èŠ±ç»™çŽ‹åŽæ²»ç—…ï¼ŒçŽ‹åŽç—…æ„ˆï¼Œç”Ÿä¸‹äº†ä¸€ä¸ªä¸€å¤´é‡‘å‘çš„å°å¥³å­©Rapunzelï¼ˆæ›¼è¿ªÂ·æ‘©å°” Mandy Moore é…éŸ³ï¼‰ã€‚å¥³å·«å¤±åŽ»é‡‘èŠ±ï¼Œå´å‘çŽ°å°å…¬ä¸»çš„é‡‘å‘æœ‰ç€åŒæ ·çš„é­”åŠ›ï¼Œå› æ­¤å¥¹å·èµ°Rapunzelï¼ŒæŠŠå¥¹å…³åˆ°æ£®æž—ä¸­çš„ä¸€åº§æ²¡æœ‰æ¥¼æ¢¯é«˜å¡”ä¹‹ä¸Šã€‚\nã€€ã€€åå…«å¹´åŽï¼ŒRapunzelåœ¨å¥³å·«çš„æŠšå…»ä¸‹é•¿æˆä¸€ä¸ªæ‹¥æœ‰é•¿é•¿é‡‘å‘çš„ç¾Žäººï¼Œå¥¹è¶Šå‘æ¸´æœ›å¤–é¢çš„ä¸–ç•Œï¼Œå¥³å·«ä¸ºäº†è‡ªå·±é’æ˜¥æ°¸é©»ï¼Œæƒ³æ–¹è®¾æ³•æŠŠRapunzelç•™åœ¨èº«è¾¹ã€‚ä¸€å¤©ï¼Œçªƒè´¼Flynnï¼ˆæ‰Žå…‹ç‘žÂ·èŽ±ç»´ Zachary Levi é…éŸ³ï¼‰ç›—å–å…¬ä¸»çŽ‹å† åŽé€ƒå…¥æ£®æž—ï¼Œåœ¨å¥½å¥‡å¿ƒè¶‹åŠ¿ä¸‹ç™»ä¸Šäº†è¿™åº§ç¥žç§˜çš„é«˜å¡”ï¼Œè¯¯æ‰“è¯¯æ’žè§åˆ°äº†å¡”ä¸­çš„é•¿å‘å…¬ä¸»ã€‚åœ¨Flynnçš„é™ªä¼´ä¸‹ï¼ŒRapunzelèµ°ä¸‹é«˜å¡”ï¼Œå¼€å§‹äº†äººç”Ÿå’Œçˆ±æƒ…çš„å¤§å†’é™©ã€‚\nã€€ã€€æœ¬ç‰‡ä¸ºè¿ªæ–¯å°¼å…¬å¸ç¬¬50éƒ¨åŠ¨ç”»é•¿ç‰‡ï¼Œæ”¹å˜è‡ªç»å…¸æ ¼æž—ç«¥è¯ã€Šé•¿å‘å…¬ä¸»ã€‹ï¼Œç”±è¿ªå£«å°¼å…ƒè€çº§ç”»å¸ˆæ ¼å…°Â·åŸºæ©é¦–æ¬¡æ‹…ä»»åŠ¨ç”»ç‰‡å¯¼æ¼”ã€‚", "downloads": [{ "title": "é­”å‘å¥‡ç¼˜", "uri": "http://dl82.80s.la:920/1312/é­”å‘å¥‡ç¼˜/é­”å‘å¥‡ç¼˜_bd.mp4", "size": "536.5 M", "type": "å¹³æ¿" }] };
  const é˜´æ›¹ä½¿è€… = { "source": "https://www.80s.tw/movie/24978", "image": "//t.dyxz.la/upload/img/201909/poster_20190907143711_94511.jpg", "title": "é˜´æ›¹ä½¿è€…", "year": 2019, "introduction": "æ­£ä¹‰æ°¸è¿œéƒ½ä¼šæœ‰äººåŽ»ä¼¸å¼ ï¼Œå› ä¸ºæœ‰å¾ˆå¤šå–„è‰¯æœ‰çˆ±çš„çˆ¸çˆ¸ï¼", "aliases": ["é©±é­”ä½¿è€…(å°)", "ä½¿è€…", "The Divine Fury", "ì‚¬ìž"], "artists": ["å®‰åœ£åŸº", "æœ´å™ä¿Š", "æ²ˆç†™ç‡®", "å´”å®‡æ¤", "æœ´æ™ºç‚«", "ç¦¹æ£¹ç„•", "éƒ‘å¿—è–°", "æŽèƒœç†™"], "types": ["åŠ¨ä½œ", "ææ€–"], "areas": ["éŸ©å›½"], "languages": ["éŸ©è¯­"], "directors": ["é‡‘å‘¨ç„•"], "releaseDate": 1564531200000, "updateDate": 1567814400000, "duration": 129, "rating": 6.3, "douban": { "id": 30181079, "commentLink": "https://movie.douban.com/subject/30181079/comments", "movieLink": "https://movie.douban.com/subject/30181079" }, "description": "ã€Šé˜´æ›¹ä½¿è€…ã€‹è®²è¿°æ­»ç¥žæ¥åˆ°é˜³é—´å‘ç”Ÿçš„æ•…äº‹ï¼ŒåŒæ—¶æ˜¯ä¸€éƒ¨å¸¦æœ‰è¶…è‡ªç„¶å…ƒç´ çš„æƒŠæ‚šåŠ¨ä½œç‰‡ã€‚å¤±åŽ»çˆ¶äº²çš„æ ¼æ–—é€‰æ‰‹å‹‡åŽšï¼ˆæœ´å™ä¿Š é¥°ï¼‰åœ¨é‡åˆ°ç¥­å¸å®‰ç¥žçˆ¶ï¼ˆå®‰èƒœåŸº é¥°ï¼‰åŽï¼Œä¸Žæ‰°ä¹±ä¸–ç•Œçš„é‚ªæ¶æ­»ç¥žå±•å¼€äº†å†³æ–—ã€‚", "downloads": [{ "title": "é˜´æ›¹ä½¿è€…", "uri": "http://dl636.80s.im:920/1909/é˜´æ›¹ä½¿è€…/é˜´æ›¹ä½¿è€….mp4", "size": "1.7 G", "type": "ç”µè§†" }] };
  const äººåœ¨å›§é€”ä¹‹æ³°å›§ = { "source": "https://www.80s.tw/movie/7417", "image": "//t.dyxz.la/upload/img/201509/poster_20150928_2091366.jpg", "title": "äººå†å›§é€”ä¹‹æ³°å›§", "year": 2012, "introduction": "å°±æ€•çŒªä¸€æ ·çš„é˜Ÿå‹ã€‚ã€‚", "aliases": ["æ³°å›§", "äººåœ¨å›§é€”2", "Lost in Thailand"], "artists": ["é»„æ¸¤ ", "é™¶è™¹", "èŒƒå†°å†°", "å¾å³¥", "çŽ‹å®å¼º", "è°¢æ¥ "], "types": ["å–œå‰§"], "areas": ["å¤§é™†"], "languages": ["å›½è¯­", "ç²¤è¯­"], "directors": ["å¾å³¥"], "releaseDate": 1355270400000, "updateDate": 1443398400000, "duration": 105, "rating": 7.5, "douban": { "id": 10574622, "commentLink": "https://movie.douban.com/subject/10574622/comments", "movieLink": "https://movie.douban.com/subject/10574622" }, "description": "ã€Šäººå†å›§é€”ä¹‹æ³°å›§ã€‹è®²è¿°äº†å•†ä¸šæˆåŠŸäººå£«å¾æœ—ï¼ˆå¾å³¥ é¥°ï¼‰ç”¨äº†äº”å¹´æ—¶é—´å‘æ˜Žäº†ä¸€ç§å«â€œæ²¹éœ¸â€çš„ç¥žå¥‡äº§å“â€”â€”æ¯æ¬¡æ±½è½¦åŠ æ²¹åªéœ€åŠ åˆ°ä¸‰åˆ†ä¹‹äºŒï¼Œå†æ»´å…¥2æ»´â€œæ²¹éœ¸â€ï¼Œæ²¹ç®±çš„æ±½æ²¹å°±ä¼šå˜æˆæ»¡æ»¡ä¸€ç®±ã€‚å¾æœ—çš„åŒå­¦ï¼Œå…¼å•†ä¸šç«žäº‰å¯¹æ‰‹é«˜åšï¼ˆé»„æ¸¤ é¥°ï¼‰æƒ³æŠŠè¿™ä¸ªå‘æ˜Žä¸€æ¬¡æ€§å–ç»™æ³•å›½äººã€‚ä½†å¾æœ—åšå†³ä¸åŒæ„ï¼Œä»–å¸Œæœ›æ·±å…¥å¼€å‘ç ”ç©¶ï¼Œ æŠŠâ€œæ²¹éœ¸â€å‘æ‰¬å…‰å¤§ï¼Œå¾—åˆ°æ›´è¿œçš„æ”¶ç›Šã€‚ä¸¤ä¸ªäººå„æŠ’å·±è§ï¼Œäº‰è®ºä¸ä¼‘ï¼Œä¸€ç›´æ— æžœã€‚ç”±äºŽä¸¤äººè‚¡ä»½ç›¸åŒï¼Œå”¯æœ‰å¾—åˆ°å…¬å¸æœ€å¤§è‚¡ä¸œå‘¨æ‰¬çš„æŽˆæƒä¹¦ï¼Œæ–¹å¯è¾¾åˆ°å„è‡ªç›®çš„ã€‚å½“å¾—çŸ¥å‘¨æ‰¬åœ¨æ³°å›½åŽï¼Œå¾æœ—ç«‹åˆ»å¯ç¨‹å¯»æ‰¾ã€‚è€Œé«˜åšèŽ·æ‚‰åŽå°†ä¸€æžšè·Ÿè¸ªå™¨æ”¾åœ¨å¾æœ—èº«ä¸Šä¸€èµ·åŽ»äº†æ³°å›½ã€‚é£žæœºä¸Šï¼Œå¾æœ—é‡åˆ°äº†çŽ‹å®ï¼ˆçŽ‹å®å¼º é¥°ï¼‰ï¼Œåˆ«æœ‰å¿ƒæœºåœ°æƒ³åˆ©ç”¨ä»–æ¥æ‘†è„±å¯¹æ‰‹é«˜åšçš„è¿½èµ¶ï¼Œå¯ä»–ä¸ä»…æ²¡ç”©æŽ‰çŽ‹å®ï¼Œè¿˜æˆäº†ä»–çš„â€œè´´èº«ä¿å§†â€â€¦â€¦\nã€€ã€€ç©¶ç«Ÿå¾æœ—å’Œé«˜åšè°ä¼šæœ€ç»ˆæ‹¿åˆ°å‘¨æ‰¬çš„æŽˆæƒä¹¦ï¼Ÿè€Œä¸‰ä¸ªå„æ€€ç›®çš„çš„äººï¼Œåˆå°†å¸¦æ¥ä¸€æ®µå¦‚ä½•çˆ†ç¬‘çš„æ³°å›½ç¥žå¥‡ä¹‹æ—…ï¼Ÿ", "downloads": [{ "title": "äººå†å›§é€”ä¹‹æ³°å›§.å›½ç²¤åŒè¯­.720P [4.36G]", "uri": "magnet:?xt=urn:btih:F4020E6C5B8D6BE5ED58D76075284F8A0BDAC336", "size": "", "type": "ç”µè§†" }] };

  let crawler: Crawler;
  let detail1: Detail;
  let detail2: Detail;
  let detail3: Detail;

  const details: Detail[] = [];
  const defineds: Detail[] = [é­”å‘å¥‡ç¼˜, é˜´æ›¹ä½¿è€…, äººåœ¨å›§é€”ä¹‹æ³°å›§];

  beforeAll(async done => {
    jasmine.DEFAULT_TIMEOUT_INTERVAL = 30 * 1000;
    crawler = new Crawler();
    done();
  });

  it(`should get detail`, async done => {
    detail1 = await crawler.getDetail('https://www.80s.tw/movie/6587');
    detail2 = await crawler.getDetail('https://www.80s.tw/movie/24978');
    detail3 = await crawler.getDetail('https://www.80s.tw/movie/7417');
    details.push(detail1, detail2, detail3);
    for (const detail of details) {
      expect(detail).toBeDefined();
    }
    done();
  });

  for (const key in é­”å‘å¥‡ç¼˜) {
    if (é­”å‘å¥‡ç¼˜.hasOwnProperty(key)) {
      it(`should get right value of key ${key}`, done => {
        for (let i = 0; i < details.length; i++) {
          const detail = details[i];
          const defined = defineds[i];
          expect(detail[key]).toEqual(defined[key]);
        }
        done();
      });
    }
  }

  afterAll(done => {
    jasmine.DEFAULT_TIMEOUT_INTERVAL = 5 * 1000;
    done();
  });

});
